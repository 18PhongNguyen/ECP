import{a as ee}from"./chunk-VEYBNXGU.js";import{a as N,c as Ae}from"./chunk-MK2QDP6Y.js";import{a as Y}from"./chunk-SDXA3ZPX.js";import{a as Be,b as Ve,c as ue,d as Z,e as qe,f as J}from"./chunk-FIL4IH3V.js";import{n as je}from"./chunk-3JLWCHR4.js";import{b as Le,c as k,f as P,g as O,k as Ge,m as T,n as D,o as R,p as K,q as E}from"./chunk-UUXI5M4A.js";import{a as ze,b as Ue}from"./chunk-77MEREZP.js";import{a as M}from"./chunk-GUPPVHVY.js";import{Ba as b,C as ge,Ca as v,F as f,Fa as de,Ga as xe,Gb as W,Hb as $,Ia as z,Ja as U,Ka as H,Kb as Re,L as ye,La as Fe,Lb as X,M as _,Ma as m,N as I,Na as G,Oa as _e,Pa as Ie,Qa as we,Ra as h,S as be,Xa as Ne,Ya as Me,Z as c,_ as p,bb as Pe,ga as Se,i as ve,ia as C,j as he,ka as s,kb as Q,lb as S,ma as ke,nb as Oe,rb as Te,sa as a,sb as g,ta as n,ua as l,wb as De,xa as Ee,ya as w,z as Ce}from"./chunk-LQR3BN6S.js";import{d as q}from"./chunk-4CLCTAJ7.js";function tt(i,t){if(i&1&&(a(0,"button",5),m(1," View your order "),n()),i&2){let e=v();xe("routerLink","/orders/",e.order.id,"")}}function rt(i,t){i&1&&(a(0,"button",6),m(1," View your orders "),n())}var te=class i{constructor(t){this.router=t;let e=this.router.getCurrentNavigation();this.order=e?.extras?.state}order;static \u0275fac=function(e){return new(e||i)(p(W))};static \u0275cmp=f({type:i,selectors:[["app-checkout-success"]],standalone:!0,features:[h],decls:9,vars:2,consts:[[1,"container","mt-5"],[1,"fa","fa-check-circle","fa-5x",2,"color","green"],[1,"mb-4"],["class","btn btn-outline-success",3,"routerLink",4,"ngIf"],["routerLink","/orders","class","btn btn-outline-success",4,"ngIf"],[1,"btn","btn-outline-success",3,"routerLink"],["routerLink","/orders",1,"btn","btn-outline-success"]],template:function(e,r){e&1&&(a(0,"div",0)(1,"div"),l(2,"i",1),n(),a(3,"h2"),m(4,"Thank you. Your order is confirmed"),n(),a(5,"p",2),m(6,"Your order has not shipped yet, but this is to be expected as we are not a real store!"),n(),C(7,tt,2,2,"button",3)(8,rt,2,0,"button",4),n()),e&2&&(c(7),s("ngIf",r.order),c(),s("ngIf",!r.order))},dependencies:[g,S,Re,$]})};function it(i,t){if(i&1){let e=w();a(0,"li",4)(1,"div",5)(2,"button",6),b("click",function(){let o=_(e).index,d=v();return I(d.onClick(o))}),m(3),n()()()}if(i&2){let e=t.$implicit,r=t.index,o=v();c(2),ke("active",o.selectedIndex===r),s("disabled",!1),c(),_e(" ",e.label," ")}}function ot(i,t){if(i&1&&(a(0,"div"),Ee(1,7),n()),i&2){let e=v();c(),s("ngTemplateOutlet",e.selected.content)}}var ie=class i extends ue{constructor(e,r,o){super(r,e,o);this.cdr=e;this.dir=r;this.elRef=o}linearModeSelected=!0;ngOnInit(){this.linear=this.linearModeSelected}onClick(e){this.selectedIndex=e}next(){this.selectedIndex<this.steps.length-1&&(this.selectedIndex=this.selectedIndex+1,this._stateChanged())}previous(){this.selectedIndex>0&&(this.selectedIndex=this.selectedIndex-1,this._stateChanged())}reset(){this.selectedIndex=0,this._stateChanged()}_stateChanged(){super._stateChanged()}static \u0275fac=function(r){return new(r||i)(p(Pe),p(Be),p(be))};static \u0275cmp=f({type:i,selectors:[["app-stepper"]],inputs:{linearModeSelected:"linearModeSelected"},standalone:!0,features:[we([{provide:ue,useExisting:i}]),Se,h],decls:4,vars:2,consts:[[1,"container"],[1,"nav","nav-pills","nav-justified"],["class","nav-item",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"nav-item"],[1,"d-grid"],[1,"nav-link","py-3","text-uppercase","fw-bold",3,"click","disabled"],[3,"ngTemplateOutlet"]],template:function(r,o){r&1&&(a(0,"div",0)(1,"ul",1),C(2,it,4,4,"li",2),n(),C(3,ot,2,1,"div",3),n()),r&2&&(c(2),s("ngForOf",o.steps),c(),s("ngIf",o.selected))},dependencies:[g,Q,S,Oe],styles:["button.nav-link[_ngcontent-%COMP%]{background:#e9ecef;border-radius:0;border:none;color:#333}button.nav-link[_ngcontent-%COMP%]:disabled:not(.active){color:#333;background:#e9ecef}"]})};function ct(i,t){if(i&1){let e=w();a(0,"div",6)(1,"div",7)(2,"h4"),m(3,"Shipping address"),n(),a(4,"button",8),b("click",function(){_(e);let o=v();return I(o.saveUserAddress())}),m(5," Save as default address "),n()(),a(6,"div",9)(7,"div",10),l(8,"app-text-input",11),n(),a(9,"div",10),l(10,"app-text-input",12),n(),a(11,"div",10),l(12,"app-text-input",13),n(),a(13,"div",10),l(14,"app-text-input",14),n(),a(15,"div",10),l(16,"app-text-input",15),n(),a(17,"div",10),l(18,"app-text-input",16),n()()()}if(i&2){let e,r=v();s("formGroup",r.checkoutForm),c(4),s("disabled",!((e=r.checkoutForm.get("addressForm"))!=null&&e.valid)||!((e=r.checkoutForm.get("addressForm"))!=null&&e.dirty)),c(4),s("label","First name"),c(2),s("label","Last name"),c(2),s("label","Street"),c(2),s("label","City"),c(2),s("label","State"),c(2),s("label","Zip code")}}var oe=class i{constructor(t,e,r){this.accountService=t;this.toastr=e;this.fb=r}checkoutForm;ngOnInit(){}saveUserAddress(){this.accountService.updateUserAddress(this.checkoutForm?.get("addressForm")?.value).subscribe({next:()=>{this.toastr.success("Address saved"),this.checkoutForm?.get("addressForm")?.reset(this.checkoutForm?.get("addressForm")?.value)},error:t=>{console.error("Error saving address:",t),this.toastr.error(t.message||"Failed to save address")}})}static \u0275fac=function(e){return new(e||i)(p(Y),p(N),p(K))};static \u0275cmp=f({type:i,selectors:[["app-checkout-address"]],inputs:{checkoutForm:"checkoutForm"},standalone:!0,features:[h],decls:8,vars:2,consts:[["class","mt-4",3,"formGroup",4,"ngIf"],[1,"d-flex","justify-content-between","flex-row","mb-5"],["routerLink","/basket",1,"btn","btn-outline-primary"],[1,"fa","fa-angle-left"],["cdkStepperNext","",1,"btn","btn-primary",3,"disabled"],[1,"fa","fa-angle-right"],[1,"mt-4",3,"formGroup"],[1,"d-flex","justify-content-between","align-items-center"],[1,"btn","btn-outline-success","mb-3",3,"click","disabled"],["formGroupName","addressForm",1,"row"],[1,"form-group","col-6"],["formControlName","firstName",3,"label"],["formControlName","lastName",3,"label"],["formControlName","street",3,"label"],["formControlName","city",3,"label"],["formControlName","state",3,"label"],["formControlName","zipcode",3,"label"]],template:function(e,r){if(e&1&&(C(0,ct,19,8,"div",0),a(1,"div",1)(2,"button",2),l(3,"i",3),m(4," Back to basket "),n(),a(5,"button",4),m(6," Go to Delivery "),l(7,"i",5),n()()),e&2){let o;s("ngIf",r.checkoutForm),c(5),s("disabled",r.checkoutForm==null||(o=r.checkoutForm.get("addressForm"))==null?null:o.invalid)}},dependencies:[J,Z,ee,g,S,E,P,O,T,R,D,$]})};var L=class i{constructor(t){this.http=t}baseUrl=X.apiUrl;createOrder(t){return this.http.post(this.baseUrl+"orders",t)}getDeliveryMethods(){return this.http.get(this.baseUrl+"orders/deliveryMethods").pipe(he(t=>t.sort((e,r)=>r.price-e.price)))}static \u0275fac=function(e){return new(e||i)(ge(De))};static \u0275prov=Ce({token:i,factory:i.\u0275fac,providedIn:"root"})};function st(i,t){if(i&1){let e=w();a(0,"div",9)(1,"div",10)(2,"input",11),b("change",function(){let o=_(e).$implicit,d=v(2);return I(d.setShippingPrice(o))}),n(),a(3,"label",12)(4,"strong"),m(5),Ne(6,"currency"),n(),l(7,"br"),a(8,"span",13),m(9),n(),l(10,"br"),a(11,"small",14),m(12),n()()()()}if(i&2){let e=t.$implicit;c(2),de("id",e.id),s("value",e.id),c(),de("for",e.id),c(2),Ie("",e.shortName," - ",Me(6,7,e.price),""),c(4),G(e.description),c(3),G(e.deliveryTime)}}function lt(i,t){if(i&1&&(a(0,"div",6)(1,"h4"),m(2,"Choose delivery method"),n(),a(3,"div",7),C(4,st,13,9,"div",8),n()()),i&2){let e=v();s("formGroup",e.checkoutForm),c(4),s("ngForOf",e.deliveryMethods)}}var ne=class i{constructor(t,e){this.checkoutService=t;this.basketService=e}checkoutForm;deliveryMethods;ngOnInit(){this.getDeliveryMethods()}getDeliveryMethods(){this.checkoutService.getDeliveryMethods().subscribe({next:t=>{console.log("Delivery methods loaded:",t),this.deliveryMethods=t},error:t=>{console.error("Error fetching delivery methods",t)}})}setShippingPrice(t){if(this.checkoutForm){let e=this.checkoutForm.get("deliveryForm");e&&(e.get("deliveryMethod")?.setValue(t.id),e.get("shippingPrice")?.setValue(t.price),this.basketService.setShippingPrice(t))}}static \u0275fac=function(e){return new(e||i)(p(L),p(M))};static \u0275cmp=f({type:i,selectors:[["app-checkout-delivery"]],inputs:{checkoutForm:"checkoutForm"},standalone:!0,features:[h],decls:8,vars:2,consts:[["class","mt-4",3,"formGroup",4,"ngIf"],[1,"d-flex","justify-content-between","flex-row","mb-5"],["cdkStepperPrevious","",1,"btn","btn-outline-primary"],[1,"fa","fa-angle-left"],["cdkStepperNext","",1,"btn","btn-primary",3,"disabled"],[1,"fa","fa-angle-right"],[1,"mt-4",3,"formGroup"],["formGroupName","deliveryForm",1,"row"],["class","col-12 col-md-6 form-group",4,"ngFor","ngForOf"],[1,"col-12","col-md-6","form-group"],[1,"form-check"],["type","radio","formControlName","deliveryMethod",1,"form-check-input",3,"change","id","value"],[1,"form-check-label","ms-2","mb-3",3,"for"],[1,"label-description"],[1,"text-muted"]],template:function(e,r){if(e&1&&(C(0,lt,5,2,"div",0),a(1,"div",1)(2,"button",2),l(3,"i",3),m(4," Back to address "),n(),a(5,"button",4),m(6," Go to Review "),l(7,"i",5),n()()),e&2){let o;s("ngIf",r.checkoutForm&&r.deliveryMethods&&r.deliveryMethods.length>0),c(5),s("disabled",r.checkoutForm==null||(o=r.checkoutForm.get("deliveryForm"))==null?null:o.invalid)}},dependencies:[Te,g,Q,S,E,Le,Ge,P,O,T,R,D,Z,qe],styles:[".form-group[_ngcontent-%COMP%]{cursor:pointer;margin-bottom:1rem}.form-check-input[_ngcontent-%COMP%]{margin-right:.5rem}.form-check-label[_ngcontent-%COMP%]{cursor:pointer;display:block;width:100%;border:1px solid #dee2e6;border-radius:.25rem;padding:1rem;transition:all .2s ease-in-out}.form-check-label[_ngcontent-%COMP%]:hover{background-color:#f8f9fa;border-color:#007bff}.form-check-input[_ngcontent-%COMP%]:checked + .form-check-label[_ngcontent-%COMP%]{background-color:#e3f2fd;border-color:#007bff}.label-description[_ngcontent-%COMP%]{color:#6c757d;font-size:.9em}strong[_ngcontent-%COMP%]{color:#212529}"]})};var ae=class i{constructor(t,e){this.basketService=t;this.toastr=e}appStepper;createPaymentIntent(){this.basketService.createPaymentIntent().subscribe({next:t=>{console.log("Payment intent response:",{paymentIntentId:t.paymentIntentId,clientSecret:t.clientSecret?.substring(0,20)+"...",hasClientSecret:!!t.clientSecret}),this.appStepper?.next()},error:t=>{this.toastr.error(t.message||"Failed to create payment intent")}})}static \u0275fac=function(e){return new(e||i)(p(M),p(N))};static \u0275cmp=f({type:i,selectors:[["app-checkout-review"]],inputs:{appStepper:"appStepper"},standalone:!0,features:[h],decls:9,vars:1,consts:[[1,"container","mt-4"],[3,"isBasket"],[1,"d-flex","justify-content-between","flex-row","mb-5"],["cdkStepperPrevious","",1,"btn","btn-outline-primary"],[1,"fa","fa-angle-left"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-angle-right"]],template:function(e,r){e&1&&(a(0,"div",0),l(1,"app-basket-summary",1),n(),a(2,"div",2)(3,"button",3),l(4,"i",4),m(5," Back to delivery "),n(),a(6,"button",5),b("click",function(){return r.createPaymentIntent()}),m(7," Go to Payment "),l(8,"i",6),n()()),e&2&&(c(),s("isBasket",!1))},dependencies:[Ue]})};var Ye="https://js.stripe.com/v3",mt=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,$e="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",pt=function(){for(var t=document.querySelectorAll('script[src^="'.concat(Ye,'"]')),e=0;e<t.length;e++){var r=t[e];if(mt.test(r.src))return r}return null},Xe=function(t){var e=t&&!t.advancedFraudSignals?"?advancedFraudSignals=false":"",r=document.createElement("script");r.src="".concat(Ye).concat(e);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(r),r},dt=function(t,e){!t||!t._registerWrapper||t._registerWrapper({name:"stripe-js",version:"2.4.0",startTime:e})},j=null,ce=null,se=null,ut=function(t){return function(){t(new Error("Failed to load Stripe.js"))}},ft=function(t,e){return function(){window.Stripe?t(window.Stripe):e(new Error("Stripe.js not available"))}},vt=function(t){return j!==null?j:(j=new Promise(function(e,r){if(typeof window>"u"||typeof document>"u"){e(null);return}if(window.Stripe&&t&&console.warn($e),window.Stripe){e(window.Stripe);return}try{var o=pt();if(o&&t)console.warn($e);else if(!o)o=Xe(t);else if(o&&se!==null&&ce!==null){var d;o.removeEventListener("load",se),o.removeEventListener("error",ce),(d=o.parentNode)===null||d===void 0||d.removeChild(o),o=Xe(t)}se=ft(e,r),ce=ut(r),o.addEventListener("load",se),o.addEventListener("error",ce)}catch(y){r(y);return}}),j.catch(function(e){return j=null,Promise.reject(e)}))},ht=function(t,e,r){if(t===null)return null;var o=t.apply(void 0,e);return dt(o,r),o},B,Ke=!1,Ze=function(){return B||(B=vt(null).catch(function(t){return B=null,Promise.reject(t)}),B)};Promise.resolve().then(function(){return Ze()}).catch(function(i){Ke||console.warn(i)});var Je=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];Ke=!0;var o=Date.now();return Ze().then(function(d){return ht(d,e,o)})};var Ct=["cardNumber"],gt=["cardExpiry"],yt=["cardCvc"];function bt(i,t){if(i&1&&(a(0,"div",10)(1,"div",11)(2,"div",12),l(3,"app-text-input",13),n()(),a(4,"div",14)(5,"div",15)(6,"div",16)(7,"label",17),m(8,"Card Number"),n(),a(9,"div",18),l(10,"div",null,0),n(),a(12,"span",19),m(13),n()()(),a(14,"div",20)(15,"div",16)(16,"label",17),m(17,"Card Expiry"),n(),a(18,"div",18),l(19,"div",null,1),n()()(),a(21,"div",20)(22,"div",16)(23,"label",17),m(24,"Card CVC"),n(),a(25,"div",18),l(26,"div",null,2),n()()()()()),i&2){let e=v();s("formGroup",e.checkoutForm),c(3),s("label","Name on card"),c(10),G(e.cardErrors)}}function St(i,t){i&1&&l(0,"i",21)}var le=class i{constructor(t,e,r,o){this.basketService=t;this.checkoutService=e;this.toastr=r;this.router=o}checkoutForm;cardNumberElement;cardExpiryElement;cardCvcElement;stripe=null;cardNumber;cardExpiry;cardCvc;cardNumberComplete=!1;cardExpiryComplete=!1;cardCvcComplete=!1;cardErrors;loading=!1;initRetryCount=0;maxRetries=20;ngOnInit(){}ngAfterViewInit(){setTimeout(()=>{this.initializeStripe()},0)}ngOnChanges(t){t.checkoutForm&&t.checkoutForm.currentValue&&!this.stripe&&(this.initRetryCount=0,setTimeout(()=>this.initializeStripe(),100))}initializeStripe(){if(!this.checkoutForm){this.initRetryCount<this.maxRetries&&(this.initRetryCount++,setTimeout(()=>this.initializeStripe(),100));return}if(!this.cardNumberElement?.nativeElement||!this.cardExpiryElement?.nativeElement||!this.cardCvcElement?.nativeElement){this.initRetryCount<this.maxRetries&&(this.initRetryCount++,setTimeout(()=>this.initializeStripe(),100));return}this.initRetryCount=0;let t=this.cardNumberElement.nativeElement,e=this.cardExpiryElement.nativeElement,r=this.cardCvcElement.nativeElement,o=t.parentElement,d=e.parentElement,y=r.parentElement;this.clearElementContent(t),this.clearElementContent(e),this.clearElementContent(r),t.removeAttribute("class"),e.removeAttribute("class"),r.removeAttribute("class"),Je(X.stripePublishableKey).then(F=>{this.stripe=F;let V=F?.elements();if(V){let pe={base:{fontSize:"16px",color:"#495057",fontFamily:'"Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',"::placeholder":{color:"#6c757d"}},invalid:{color:"#dc3545"}};this.cardNumber=V.create("cardNumber",{style:pe}),this.cardNumber&&(this.cardNumber.mount(t),this.cardNumber.on("change",u=>{this.cardNumberComplete=u.complete,u.error?(this.cardErrors=u.error.message,o?.classList.add("has-error"),o?.classList.remove("is-complete")):(this.cardErrors=null,o?.classList.remove("has-error"),u.complete?o?.classList.add("is-complete"):o?.classList.remove("is-complete"))})),this.cardExpiry=V.create("cardExpiry",{style:pe}),this.cardExpiry&&(this.cardExpiry.mount(e),this.cardExpiry.on("change",u=>{this.cardExpiryComplete=u.complete,u.error?(this.cardErrors=u.error.message,d?.classList.add("has-error"),d?.classList.remove("is-complete")):(this.cardErrors=null,d?.classList.remove("has-error"),u.complete?d?.classList.add("is-complete"):d?.classList.remove("is-complete"))})),this.cardCvc=V.create("cardCvc",{style:pe}),this.cardCvc&&(this.cardCvc.mount(r),this.cardCvc.on("change",u=>{this.cardCvcComplete=u.complete,u.error?(this.cardErrors=u.error.message,y?.classList.add("has-error"),y?.classList.remove("is-complete")):(this.cardErrors=null,y?.classList.remove("has-error"),u.complete?y?.classList.add("is-complete"):y?.classList.remove("is-complete"))}))}}).catch(F=>{console.error("Error loading Stripe:",F)})}clearElementContent(t){for(;t.firstChild;)t.removeChild(t.firstChild);t.textContent="",t.innerHTML=""}get paymentFormComplete(){return this.checkoutForm?.get("paymentForm")?.valid&&this.cardNumberComplete&&this.cardExpiryComplete&&this.cardCvcComplete}submitOrder(){return q(this,null,function*(){this.loading=!0;let t=this.basketService.getCurrentBasketValue();if(!t)throw new Error("cannot get basket");try{let e=yield this.createOrder(t),r=yield this.confirmPaymentWithStripe(t);if(r.paymentIntent){this.basketService.deleteBasket(t);let o={state:e};this.router.navigate(["checkout/success"],o)}else this.toastr.error(r.error.message)}catch(e){console.log(e),this.toastr.error(e.message)}finally{this.loading=!1}})}confirmPaymentWithStripe(t){return q(this,null,function*(){if(!t)throw new Error("Basket is null");if(!t.clientSecret)throw new Error("No client secret available");console.log("Confirming payment with:",{paymentIntentId:t.paymentIntentId,clientSecret:t.clientSecret?.substring(0,20)+"..."});let e=this.stripe?.confirmCardPayment(t.clientSecret,{payment_method:{card:this.cardNumber,billing_details:{name:this.checkoutForm?.get("paymentForm")?.get("nameOnCard")?.value}}});if(!e)throw new Error("Problem attempting payment with stripe");return e})}createOrder(t){return q(this,null,function*(){if(!t)throw new Error("Basket is null");let e=this.getOrderToCreate(t);return ve(this.checkoutService.createOrder(e))})}getOrderToCreate(t){let e=this.checkoutForm?.get("deliveryForm")?.get("deliveryMethod")?.value,r=this.checkoutForm?.get("addressForm")?.value;if(!e||!r)throw new Error("Problem with basket");return{basketId:t.id,deliveryMethodId:e,shipToAddress:r}}static \u0275fac=function(e){return new(e||i)(p(M),p(L),p(N),p(W))};static \u0275cmp=f({type:i,selectors:[["app-checkout-payment"]],viewQuery:function(e,r){if(e&1&&(z(Ct,5),z(gt,5),z(yt,5)),e&2){let o;U(o=H())&&(r.cardNumberElement=o.first),U(o=H())&&(r.cardExpiryElement=o.first),U(o=H())&&(r.cardCvcElement=o.first)}},inputs:{checkoutForm:"checkoutForm"},standalone:!0,features:[ye,h],decls:9,vars:3,consts:[["cardNumber",""],["cardExpiry",""],["cardCvc",""],["class","mt-4",3,"formGroup",4,"ngIf"],[1,"d-flex","justify-content-between","flex-row","mb-5"],["cdkStepperPrevious","",1,"btn","btn-outline-primary"],[1,"fa","fa-angle-left"],[1,"btn","btn-primary",3,"click","disabled"],[1,"fa","fa-angle-right"],["class","fa fa-spinner fa-spin",4,"ngIf"],[1,"mt-4",3,"formGroup"],[1,"row"],["formGroupName","paymentForm",1,"form-group","col-12"],["formControlName","nameOnCard",3,"label"],[1,"row","mb-3"],[1,"col-6"],[1,"form-group"],[1,"form-label"],[1,"stripe-container"],[1,"text-danger"],[1,"col-3"],[1,"fa","fa-spinner","fa-spin"]],template:function(e,r){e&1&&(C(0,bt,28,3,"div",3),a(1,"div",4)(2,"button",5),l(3,"i",6),m(4," Back to review "),n(),a(5,"button",7),b("click",function(){return r.submitOrder()}),m(6," Submit order "),l(7,"i",8),C(8,St,1,0,"i",9),n()()),e&2&&(s("ngIf",r.checkoutForm),c(5),s("disabled",r.loading||!r.paymentFormComplete),c(3),s("ngIf",r.loading))},dependencies:[ee,E,P,O,T,R,D,g,S],styles:[".stripe-container[_ngcontent-%COMP%]{border:1px solid #ced4da;border-radius:.375rem;background-color:#fff;padding:.75rem;min-height:calc(1.5em + .75rem + 2px);transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.stripe-container[_ngcontent-%COMP%]:focus-within{border-color:#80bdff;box-shadow:0 0 0 .2rem #007bff40}.stripe-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;height:100%}.StripeElement[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5;color:#495057;font-family:Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif}.StripeElement[_ngcontent-%COMP%]:focus{outline:none}.StripeElement--focus[_ngcontent-%COMP%]{outline:none}.StripeElement--invalid[_ngcontent-%COMP%]{color:#dc3545}.StripeElement--complete[_ngcontent-%COMP%]{color:#28a745}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{margin-bottom:.5rem;font-weight:500;color:#495057}.stripe-container.has-error[_ngcontent-%COMP%]{border-color:#dc3545;box-shadow:0 0 0 .2rem #dc354540}.stripe-container.is-complete[_ngcontent-%COMP%]{border-color:#28a745}"]})};var me=class i{constructor(t,e){this.fb=t;this.accountService=e}checkoutForm;ngOnInit(){this.createCheckoutForm(),this.getAddressFormValues()}createCheckoutForm(){this.checkoutForm=this.fb.group({addressForm:this.fb.group({firstName:[null,k.required],lastName:[null,k.required],street:[null,k.required],city:[null,k.required],state:[null,k.required],zipcode:[null,k.required]}),deliveryForm:this.fb.group({deliveryMethod:[null,k.required],shippingPrice:[null,k.required]}),paymentForm:this.fb.group({nameOnCard:[null,k.required]})})}getAddressFormValues(){this.accountService.getUserAddress().subscribe({next:t=>{t&&this.checkoutForm.get("addressForm")?.patchValue({firstName:t.firstName,lastName:t.lastName,street:t.street,city:t.city,state:t.state,zipcode:t.zipcode})},error:t=>{console.error("Error fetching address",t)}})}static \u0275fac=function(e){return new(e||i)(p(K),p(Y))};static \u0275cmp=f({type:i,selectors:[["app-checkout"]],standalone:!0,features:[h],decls:15,vars:11,consts:[["appStepper",""],[1,"container","mt-5"],[1,"row"],[1,"col-8"],[3,"label","completed"],[3,"checkoutForm"],[3,"label"],[3,"appStepper"],[1,"col-4"]],template:function(e,r){if(e&1&&(a(0,"div",1)(1,"div",2)(2,"div",3)(3,"app-stepper",null,0)(5,"cdk-step",4),l(6,"app-checkout-address",5),n(),a(7,"cdk-step",4),l(8,"app-checkout-delivery",5),n(),a(9,"cdk-step",6),l(10,"app-checkout-review",7),n(),a(11,"cdk-step",4),l(12,"app-checkout-payment",5),n()()(),a(13,"div",8),l(14,"app-order-totals"),n()()()),e&2){let o,d,y,F=Fe(4);c(5),s("label","Address")("completed",(o=r.checkoutForm.get("addressForm"))==null?null:o.valid),c(),s("checkoutForm",r.checkoutForm),c(),s("label","Delivery")("completed",(d=r.checkoutForm.get("deliveryForm"))==null?null:d.valid),c(),s("checkoutForm",r.checkoutForm),c(),s("label","Review"),c(),s("appStepper",F),c(),s("label","Payment")("completed",(y=r.checkoutForm.get("paymentForm"))==null?null:y.valid),c(),s("checkoutForm",r.checkoutForm)}},dependencies:[g,je,ze,ie,J,Ve,oe,ne,ae,le,E]})};var Ir=[{path:"",component:me},{path:"success",component:te,canActivate:[Ae],data:{breadcrumb:"Success"}}];export{Ir as routes};
