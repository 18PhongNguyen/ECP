import{a as k}from"./chunk-VEYBNXGU.js";import{a as A}from"./chunk-SDXA3ZPX.js";import{c as s,f as I,g as T,j as w,m as O,o as D,p as M,q as G}from"./chunk-UUXI5M4A.js";import{Ba as C,Ca as y,F,Gb as R,Ma as p,Oa as S,Ra as N,Z as r,_ as l,g as d,ia as u,j as c,ka as n,kb as _,lb as x,p as f,q as g,s as v,sa as a,sb as E,ta as m,u as b,ua as h}from"./chunk-LQR3BN6S.js";import"./chunk-4CLCTAJ7.js";function L(i,e){if(i&1&&(a(0,"li"),p(1),m()),i&2){let t=e.$implicit;r(),S(" ",t," ")}}function P(i,e){if(i&1&&(a(0,"ul",10),u(1,L,2,1,"li",11),m()),i&2){let t=y();r(),n("ngForOf",t.errors)}}var j=/^[\w\.=-]+@[\w\.-]+\.[\w]{2,3}$/,V=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[\W_]).{8,50}$/,q=500,B=class i{constructor(e,t,o){this.fb=e;this.accountService=t;this.router=o}registerForm;errors;isLoading=!1;ngOnInit(){this.createRegisterForm()}createRegisterForm(){this.registerForm=this.fb.group({displayName:["",[s.required]],email:["",[s.required,s.pattern(j)],[this.validateEmailNotTaken()]],password:["",[s.required,s.pattern(V)]]})}onSubmit(){if(this.registerForm?.invalid){this.registerForm?.markAllAsTouched();return}this.isLoading=!0,this.errors=void 0,this.accountService.register(this.registerForm?.value).subscribe({next:()=>{this.router.navigateByUrl("/shop")},error:e=>{this.isLoading=!1,this.errors=e.errors||["An unexpected error occurred"]},complete:()=>{this.isLoading=!1}})}validateEmailNotTaken(){return e=>!e.value||e.errors?.pattern?d(null):e.valueChanges.pipe(f(q),g(),b(t=>this.accountService.checkEmailExists(t).pipe(c(o=>o?{emailExists:!0}:null))),v())}static \u0275fac=function(t){return new(t||i)(l(M),l(A),l(R))};static \u0275cmp=F({type:i,selectors:[["app-register"]],standalone:!0,features:[N],decls:12,vars:7,consts:[[1,"d-flex","justify-content-center","mt-5"],[1,"col-3"],[1,"form-signin",3,"ngSubmit","formGroup"],[1,"text-center","mb-4"],[1,"h3","mb-3","font-weight-normal"],["formControlName","displayName",3,"label"],["formControlName","email",3,"label"],["formControlName","password",3,"label","type"],["class","text-danger list-unstyled",4,"ngIf"],["type","submit",1,"btn","btn-lg","btn-primary","btn-block",2,"width","100%",3,"disabled"],[1,"text-danger","list-unstyled"],[4,"ngFor","ngForOf"]],template:function(t,o){t&1&&(a(0,"div",0)(1,"div",1)(2,"form",2),C("ngSubmit",function(){return o.onSubmit()}),a(3,"div",3)(4,"h1",4),p(5,"Sign up"),m()(),h(6,"app-text-input",5)(7,"app-text-input",6)(8,"app-text-input",7),u(9,P,2,1,"ul",8),a(10,"button",9),p(11,"Register"),m()()()()),t&2&&(r(2),n("formGroup",o.registerForm),r(4),n("label","Display Name"),r(),n("label","Email address"),r(),n("label","Password")("type","password"),r(),n("ngIf",o.errors),r(),n("disabled",o.registerForm==null?null:o.registerForm.invalid))},dependencies:[G,w,I,T,O,D,E,_,x,k]})};export{B as RegisterComponent};
