import{C as o,Gb as p,Lb as U,d as n,g as a,j as r,ub as u,wb as c,z as l}from"./chunk-LQR3BN6S.js";var h=class s{constructor(t,e){this.http=t;this.router=e}baseUrl=U.apiUrl;currentUserSource=new n(1);currentUser$=this.currentUserSource.asObservable();loadCurrentUser(t){if(t===null)return this.currentUserSource.next(null),a(null);let e=new u;return e=e.set("Authorization",`Bearer ${t}`),this.http.get(this.baseUrl+"account",{headers:e}).pipe(r(i=>(this.setCurrentUser(i),localStorage.setItem("token",i.token),i)))}login(t){return this.http.post(this.baseUrl+"account/login",t).pipe(r(e=>{e&&(localStorage.setItem("token",e.token),this.setCurrentUser(e))}))}register(t){return this.http.post(this.baseUrl+"account/register",t).pipe(r(e=>{e&&(localStorage.setItem("token",e.token),this.setCurrentUser(e))}))}logout(){localStorage.removeItem("token"),this.currentUserSource.next(null),this.router.navigateByUrl("/")}checkEmailExists(t){return this.http.get(this.baseUrl+"account/emailexists?email="+t)}getCurrentUser(){return this.currentUserSource.asObservable()}setCurrentUser(t){this.currentUserSource.next(t)}getUserAddress(){return this.http.get(this.baseUrl+"account/address")}updateUserAddress(t){return this.http.put(this.baseUrl+"account/address",t)}static \u0275fac=function(e){return new(e||s)(o(c),o(p))};static \u0275prov=l({token:s,factory:s.\u0275fac,providedIn:"root"})};export{h as a};
